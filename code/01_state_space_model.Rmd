---
title: "状態空間モデル"
output:
  rmdformats::readthedown:
    highlight: kate
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# 状態方程式・観測方程式

線形ガウス状態空間モデルは下記のように定式化される。  
上が状態方程式、下が観測方程式。  



$$
\begin{aligned}
x_{t}&=T_{t}x_{t-1}+R_{t}\xi _{t}, &~~~~~~\xi _{t}\sim N\left( 0,Q_{t}\right)\\
y_{t}&=Z_{t}x_{t}+\varepsilon_{t}, &~~~~~~\varepsilon _{t}\sim N\left( 0,H_{t}\right) 
\end{aligned}\tag{1}
$$

$x_{t}$は$t$時点の状態を表す。状態は、$k$次元のベクトルを取る。つまり、状態を様々な要素の和として表現することができる。  
$y_{t}$は$t$時点の観測値。$T_{t}, R_{t}, Z_{t}$はモデルの表現形式を決める行列となる。  

日本語だと以下の表現になる。  



$$
\begin{aligned}
状態 &= 前時点の状態を用いた予測値 + 過程誤差\\
観測 &= 状態 + 観測誤差
\end{aligned}\tag{2}
$$

#  データの表現とパラメタ推定

データの表現とパラメタ推定は分けて理解すべき。  

## データの表現
データの表現は、状態方程式と観測方程式で表される。 


## パラメータ推定

～フィルタ系と、MCMCを用いるグループの大きく2つに分かれる。  
フィルタリングの代表としては、カルマンフィルタが有名。   
MCMCの代表として、HMC法など。  
最も有名な方法は、カルマンフィルタ+最尤法。  




# 状態推定：予測とフィルタリング

フィルタリングは、手に入った**観測値を用いて予測された状態の値を補正**することを指す。  
状態方程式における状態の更新式を用いて予測を行う。




